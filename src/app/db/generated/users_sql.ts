// Code generated by sqlc. DO NOT EDIT.

import { Sql } from "postgres";

export const createUserQuery = `-- name: CreateUser :one
INSERT INTO users (discord_id, gold) VALUES ($1, 0) RETURNING discord_id, gold, joined_at`;

export interface CreateUserArgs {
    discordId: string;
}

export interface CreateUserRow {
    discordId: string;
    gold: number;
    joinedAt: Date | null;
}

export async function createUser(sql: Sql, args: CreateUserArgs): Promise<CreateUserRow | null> {
    const rows = await sql.unsafe(createUserQuery, [args.discordId]).values();
    if (rows.length !== 1) {
        return null;
    }
    const row = rows[0];
    if (!row) {
        return null;
    }
    return {
        discordId: row[0],
        gold: row[1],
        joinedAt: row[2]
    };
}

export const getByDiscordIDQuery = `-- name: GetByDiscordID :one
SELECT discord_id, gold, joined_at FROM users WHERE discord_id = $1 LIMIT 1`;

export interface GetByDiscordIDArgs {
    discordId: string;
}

export interface GetByDiscordIDRow {
    discordId: string;
    gold: number;
    joinedAt: Date | null;
}

export async function getByDiscordID(sql: Sql, args: GetByDiscordIDArgs): Promise<GetByDiscordIDRow | null> {
    console.log("getting user")
    const rows = await sql.unsafe(getByDiscordIDQuery, [args.discordId]).values();
    console.log("Got user")
    if (rows.length !== 1) {
        return null;
    }
    const row = rows[0];
    if (!row) {
        return null;
    }
    return {
        discordId: row[0],
        gold: row[1],
        joinedAt: row[2]
    };
}

export const setGoldQuery = `-- name: SetGold :one
UPDATE users SET gold = $1 WHERE discord_id = $2 RETURNING discord_id, gold, joined_at`;

export interface SetGoldArgs {
    gold: number;
    discordId: string;
}

export interface SetGoldRow {
    discordId: string;
    gold: number;
    joinedAt: Date | null;
}

export async function setGold(sql: Sql, args: SetGoldArgs): Promise<SetGoldRow | null> {
    const rows = await sql.unsafe(setGoldQuery, [args.gold, args.discordId]).values();
    if (rows.length !== 1) {
        return null;
    }
    const row = rows[0];
    if (!row) {
        return null;
    }
    return {
        discordId: row[0],
        gold: row[1],
        joinedAt: row[2]
    };
}

